MATLAB solutions provided by davluangu.